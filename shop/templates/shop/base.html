{% load i18n static %}

<!DOCTYPE html>
<html lang="{% get_current_language as LANGUAGE_CODE %}{{ LANGUAGE_CODE }}">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}{% translate "My Shop" %}{% endblock %}</title>
    <link href="{% static 'css/base.css' %}" rel="stylesheet" />
  </head>

  <body>
    <div id="header">
      <a href="{% url 'shop:product_list' %}" class="logo">{% translate "My Shop" %}</a>

      {% get_current_language as LANGUAGE_CODE %}
      {% get_available_languages as LANGUAGES %}
      {% get_language_info_list for LANGUAGES as languages %}

      <div class="languages">
        <p>{% translate "Language" %}:</p>
        <ul>
          {% for language in languages %}
            <li>
              <form action="{% url 'set_language' %}" method="post" style="display:inline;">
                {% csrf_token %}
                {# IMPORTANT: use current path, do NOT construct /es/... yourself #}
                <input type="hidden" name="next" value="{{ request.path }}">
                <input type="hidden" name="language" value="{{ language.code }}">
                <button type="submit" {% if language.code == LANGUAGE_CODE %}class="selected"{% endif %}>
                  {{ language.name_local }}
                </button>
              </form>
            </li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div id="subheader">
      <div class="cart">
        {% with total_items=cart|length %}
          {% if total_items > 0 %}
            {% translate "Your cart" %}:
            <a href="{% url 'cart:cart_detail' %}">
              {% blocktranslate count items=total_items with total=cart.get_total_price %}
                {{ items }} item, £{{ total }}
              {% plural %}
                {{ items }} items, £{{ total }}
              {% endblocktranslate %}
            </a>
          {% elif not order %}
            {% translate "Your cart is empty." %}
          {% endif %}
        {% endwith %}
      </div>
    </div>

    <div id="content">
      {% block content %}{% endblock %}
    </div>
  </body>
</html>
